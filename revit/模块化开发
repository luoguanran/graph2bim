## 1.引入RevitApi类库
# 引用
import clr
clr.AddReference('RevitAPI')
clr.AddReference('RevitAPIUI')
clr.AddReference("System")
# 导入
from Autodesk.Revit.UI import *
from Autodesk.Revit.DB import *
## 2.实例当前程序变量（可忽略）
uidoc = __revit__.ActiveUIDocument
uiapp = __revit__.Application

# 当前文档
doc = uidoc.Document
## 3.1.事务装饰器
def transaction(func):
    def wrapper(*args, **kwargs):
        t = Transaction(doc, "pyRevit")
        t.Start()
        try:
            f = func(*args, **kwargs)
            if f:
                t.Commit()
            else:
                t.RollBack()
        except Exception as e:
            print("Error:%s" % e)
            t.RollBack()
            f = False
        return f
    return wrapper
## 3.2.过滤器
class pyRevit(object):
    @staticmethod
    def of_class(typeof):
        return FilteredElementCollector(doc).OfClass(typeof).ToElements()

## 4.功能业务(自实现)
class App(pyRevit):
    def __init__(self):
        pass
    @transaction
    def main(self):
        try:
            # 这里写业务代码
            return 1
        except Exception as e:
            print(e)
            return 0


if __name__ == '__main__':
    app = App()
    app.main()